var forceGraph=function(t,e){this.config=e,this.data=t,this.edges=this.getEdges(),this.nodes=this.getNodes(),this.createElements();var r=this.svg.selectAll(".link").data(this.edges).enter().append("line").attr("class","link").attr("marker-end","url(#end)").style("stroke-width",1).style("stroke-dasharray",function(t){return 0===t.score?"5,5":void 0}),n=this.svg.selectAll(".node").data(t.nodes).enter().append("circle").attr("class","node").attr("r",5).call(this.force.drag).style("fill",function(t){return/^NM_[0-9]{5,}/i.test(t.Name)?"#5bd0f0":"#d99db5"});n.on("dblclick.zoom",function(t){d3.event.stopPropagation();var e=window.innerWidth/2-t.x*zoom.scale(),r=window.innerHeight/2-t.y*zoom.scale();zoom.translate([e,r]),g.attr("transform","translate("+e+","+r+")scale("+zoom.scale()+")")}),n.append("title").text(function(t){return t.Name}),this.force.on("tick",function(){r.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),n.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})})};forceGraph.prototype.getData=function(t){return t.links=t.links.filter(function(t){return 1===t.score}),console.log(t.links.length),t},forceGraph.prototype.getEdges=function(){var t=[];return this.data.links.forEach(function(e){var r=this.data.nodes.filter(function(t){return t.ID===e.source})[0],n=this.data.nodes.filter(function(t){return t.ID===e.target})[0];t.push({source:r,target:n,score:e.score})}),t},forceGraph.prototype.getNodes=function(){return this.data.nodes},forceGraph.prototype.createElements=function(){var t=this.config.width||1e3;height=this.config.height||800;d3.scale.category20();this.svg=d3.select(this.config.targetDOM).append("svg").attr("width",t).attr("height",height),this.force=d3.layout.force().charge(-70).linkDistance(50).size([t,height]).nodes(this.nodes).links(this.edges).start(),this.svg.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5")},$(document).ready(function(){$("body").scrollspy({target:"#target_nav",offset:50})}),$(document).ready(function(){var t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"../data/genes.json"}),e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"../data/variants.json"});$("input.typeahead").typeahead({highlight:!0},{name:"genes",source:t,templates:{header:'<h3 class="searchbar-header-genes">Genes</h3>'}},{name:"variants",source:e,templates:{header:'<h3 class="searchbar-header-variants">Variants</h3>'}})}),$(document).ready(function(){$("input.typeahead").bind("typeahead:select",function(t,e){/^NM_[0-9]{5,}/i.test(e)?window.location.href="/variant/"+e:window.location.href="/gene/"+e})});